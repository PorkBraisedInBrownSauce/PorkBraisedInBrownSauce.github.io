<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 使用MPI和OPENMP优化的Kmeans-BIC算法 · ClT's Blog</title><meta name="description" content="使用MPI和OPENMP优化的Kmeans-BIC算法 - ClT"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/foowaa" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/index.html" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">使用MPI和OPENMP优化的Kmeans-BIC算法</h1><div class="post-time">Sep 29, 2016</div><div class="post-content"><p>由于一点缘故，前一阵子写了一个基于<a href="http://www.mpich.org" target="_blank" rel="external">MPI</a>和<a href="http://www.openmp.org" target="_blank" rel="external">OPENMP</a>的CPU高并行的Kmeans程序。这个程序的工作是基于[1]，一方面加入了OPENMP的线程级别并行优化，另一方面加入了BIC自动选择cluster个数的能力，这个的想法主要基于[2]，但是实现有一些区别。在<a href="http://www.nscc-gz.cn/" target="_blank" rel="external">天河-2</a>运行结果显示：加速比接近于5倍，而且具有初始化的鲁棒性。</p>
<p>由于是第一次写MPI和OPENMP的程序，对进程并行和线程并行理解不清，在这篇文章简单解释一下。</p>
<p>MPI主要是在定义一套通信标准，就像通信网一样，不同进程之间由于是互相不知情的，所以怎么让进程之间相互协作就是MPI最重要解决的问题。由于是基于map-reduce思想，不是所有程序都可以使用MPI，一般来说，使用MPI会使程序发生很大的结构变化。书写MPI程序从顶层结构来讲：主体部分+通信部分。主体部分包含程序不同进程的处理，通信部分包含进程间的协作。具体API可以参考[3]。</p>
<p>OPENMP相对来讲简单很多，VS一类IDE的支持也很好，只需要写一些宏语句，编译器就可以很好地编译。因为是线程之间的并行，不存在人为的设定不同线程之间怎样通信的问题。需要做的主要是找出热点使用OPENMP和线程同步问题。线程同步问题可以参考[4]，OPENMP主要实现了：互斥锁（mutex），临界区域（automic, critical），事件。</p>
<p>代码见Github：<a href="https://github.com/foowaa/miscellaneous_code/tree/master/kmeans_parabic" target="_blank" rel="external">https://github.com/foowaa/miscellaneous_code/tree/master/kmeans_parabic</a></p>
<p>Reference:<br>[1] <a href="https://code.google.com/archive/p/pspectralclustering/" target="_blank" rel="external">https://code.google.com/archive/p/pspectralclustering/</a><br>[2] Pelleg, Dan, and Andrew W. Moore. “X-means: Extending K-means with Efficient Estimation of the Number of Clusters.” ICML. Vol. 1. 2000.<br>[3] <a href="http://micro.ustc.edu.cn/Linux/MPI/MPICH/" target="_blank" rel="external">http://micro.ustc.edu.cn/Linux/MPI/MPICH/</a><br>[4] <a href="http://yoyzhou.github.io/blog/2013/02/28/python-threads-synchronization-locks/" target="_blank" rel="external">http://yoyzhou.github.io/blog/2013/02/28/python-threads-synchronization-locks/</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/09/28/安装Torch和相关东西的小脚本/" class="next">NEXT</a></div><div data-thread-key="2016/09/29/使用MPI和OPENMP优化的Kmeans-BIC算法/" data-title="使用MPI和OPENMP优化的Kmeans-BIC算法" data-url="http://yoursite.com/2016/09/29/使用MPI和OPENMP优化的Kmeans-BIC算法/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"seansun"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2016 <a href="http://yoursite.com">ClT</a>.This simple Blog is created by Hexo.</p></div></footer><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>